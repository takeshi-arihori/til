# ネットワークとコンテンツ

### AWS Auganizations: マルチアカウント
VPCをプロジェクトごとに作成し、権限をそれぞれに付与できる。

### VPC
3つのAZを利用可能

### サブネット
小さなネットワークを設定してセキュリティレベルを高める。
AZを跨げない。
VPCのアドレスレンジ帯は /16 ~ /28

### Public subnet
インターネット接続可
ルートテーブルにインターネットゲートウェイへのルーティング有

### Private subnet
インターネット接続不可
ルートテーブルにインターネットゲートウェイへのルーティング無

### サブネット構成
サブネットを同じ構成で複数のAZに配置する
マルチAZで障害対策

- IPアドレス: 
各サブネット /24 で分けることがおすすめ(サブネットあたり256個のIPアドレスを確保できる,第3おくテッドが変わるので認識しやすい)
最小単位の /28 で作成するとロードバランサーが設定できない。(最低20個のIPアドレスが必要)

### ENI(Elastic Network Interface)
EC2にはENIが付与されている
ENIには複数のIPアドレスを設定すること

| Security group | Network ACL |
| -------------- | ----------- |
| ステートフル    | ステートレス |
| ENIに設定      | サブネット単位で設定 |
| 許可ルールのみ設定可能 | 許可/拒否ルールを設定可能 |
| 評価は累積的に行う | 評価は低い番号順に行う |


### 手順
1. VPC
2. Subnet
3. internet gatewayを作成: 作成したVPCにアタッチ
4. ルートテーブルの設定: Subnet -> ルートテーブルのリンクに飛ぶ -> ルートを編集で送信先 0.0.0.0/0 , インターネットゲートウェイを指定
5. EC2インスタンスの作成
6. セキュリティグループの作成とEC2へのアタッチ
   Q1: インバウンドルールとは
   Q2: アウトバウンドルールとは
7. ELBの割り当て: EC2を停止するとIPアドレスが変わってしまうため。インスタンスにアタッチ/デタッチ可能で静的なパブリックIPアドレス

