# オートスケーリング

システム利用者の増大に応じて、システム規模を拡大縮小すること。
- トラフィック多い -> コンテナ増
- トラフィック少ない -> コンテナ減

## スケーリングの種類
### 水平スケーリング (ECSサポート)
サーバの数を増減すること -> 処理をなるべく分散させるアプローチ
- スケールアウト: サーバの数を増やすこと
- スケールイン: サーバの数を減らすこと

#### 得意
一つ一つの処理は軽めだが大量の処理を行う必要がある。
例: ECでひとつひとつのユーザーからのリクエストなど。認知が上がり大量のアクセスが起こる場合など

#### 苦手
一つ一つの処理が高度な内容、メモリをたくさん消費する処理など。
状態を持つようなユースケースなど。ユーザー -> サーバへリクエスト -> 事前の状態を把握する必要がある場合など。(複雑性が増し設計が困難)

### 垂直スケーリング
サーバのCPUなどを変更すること。
- スケールアップ: 増やす
- スケールダウン: 減らす

#### 得意
大量のCPUやメモリをさばくこと。
動画、画像処理などの処理。
状態を持つようなユースケース。

#### 苦手
物理的にスケールアップの上限がある。
サーバの置き換えの際に落ちないか不安。

### ECSのサポートするスケーリング
#### ステップスケーリングポリシー(カスタマイズ性は高い)
CPUやメモリ使用率に応じて定義されたコンテナ数に合わせる。
例: CPU使用率 30 % -> 3個、60 % -> 5 個にする。
割合で設定も可能。(1.5倍など)

#### ターゲット追跡スケーリングポリシー (こちらを選択することが多い)
CPUやメモリのターゲット使用率になるようコンテナ数を増減させる。

ターゲット追跡アラームがユースケースで機能しない場合にステップスケーリングを使用する。

![learn-ecs-Auto Scaling drawio](https://github.com/user-attachments/assets/13554676-05b7-4773-8b52-69e5ebb461b0)


![learn-ecs-sec08-handson drawio](https://github.com/user-attachments/assets/cf772de0-b0b3-4010-a58c-d80674bedf3d)



